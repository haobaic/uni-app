{"version":3,"sources":["webpack:///C:/Users/Administrator/Desktop/学习/测试/main.js","webpack:///C:/Users/Administrator/Desktop/学习/测试/pages/socket/index.vue?da37","webpack:///C:/Users/Administrator/Desktop/学习/测试/pages/socket/index.vue?493c","webpack:///C:/Users/Administrator/Desktop/学习/测试/pages/socket/index.vue?3179","webpack:///C:/Users/Administrator/Desktop/学习/测试/pages/socket/index.vue?0695","webpack:///C:/Users/Administrator/Desktop/学习/测试/pages/socket/index.vue","webpack:///C:/Users/Administrator/Desktop/学习/测试/pages/socket/index.vue?8cd8","webpack:///C:/Users/Administrator/Desktop/学习/测试/pages/socket/index.vue?f77e"],"names":["createPage","Page","data","scrollTop","list","limit","lockReconnect","count","massage","devtools","uni","getSystemInfoSync","platform","onLoad","linkSocket","methods","that","connectSocket","url","success","initEventHandle","onSocketOpen","console","log","message","sendSocketMessage","onSocketError","res","reconnect","onSocketClose","onSocketMessage","msg","JSON","parse","id","role","push","rollingBottom","clearTimeout","timer","setTimeout","send","wx","content","showToast","title","icon","duration","scroll","e","detail","scrollTo","bindChange","value","onUnload","createSelectorQuery","selectAll","boundingClientRect","rects","forEach","rect","bottom","exec"],"mappings":"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","file":"pages/socket/index.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\n\nimport Vue from 'vue'            \nimport Page from './pages/socket/index.vue'\ncreatePage(Page)","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=1b4abb47&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=1b4abb47&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1b4abb47\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('1b4abb47', component.options)\n    } else {\n      api.reload('1b4abb47', component.options)\n    }\n    module.hot.accept(\"./index.vue?vue&type=template&id=1b4abb47&scoped=true&\", function () {\n      api.rerender('1b4abb47', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"C:/Users/Administrator/Desktop/学习/测试/pages/socket/index.vue\"\nexport default component.exports","export * from \"-!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=template&id=1b4abb47&scoped=true&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tscrollTop: 0,\n\t\t\tlist: [],\n\t\t\tlimit: 0,\n\t\t\tlockReconnect: false,\n\t\t\tcount: 0,\n\t\t\tmassage: '',\n\t\t\tdevtools: uni.getSystemInfoSync().platform == \"devtools\",\n\t\t}\n\t},\n\t// 监听页面加载\n\tonLoad: function() {\n\t\tthis.linkSocket()\n\t},\n\tmethods: {\n\t\t//建立websocket连接\n\t\tlinkSocket() {\n\t\t\tvar that = this\n\t\t\tuni.connectSocket({\n\t\t\t\t// 本地服务器地址\n\t\t\t\turl: 'ws://localhost:3000',\n\t\t\t\tsuccess() {\n\t\t\t\t\tthat.initEventHandle()\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\t//绑定事件\n\t\tinitEventHandle() {\n\t\t\tvar that = this\n\t\t\tuni.onSocketOpen(() => {\n\t\t\t\tconsole.log('WebSocket连接打开')\n\t\t\t\tthis.message = ''\n\t\t\t\tuni.sendSocketMessage({\n\t\t\t\t\tdata: this.message,\n\t\t\t\t})\n\t\t\t})\n\t\t\tuni.onSocketError((res) => {\n\t\t\t\tconsole.log('WebSocket连接打开失败')\n\t\t\t\tthat.reconnect()\n\t\t\t})\n\t\t\tuni.onSocketClose((res) => {\n\t\t\t\tconsole.log('WebSocket 已关闭！')\n\t\t\t\tthat.reconnect()\n\t\t\t})\n\t\t\tuni.onSocketMessage(msg => {\n\t\t\t\tvar data = JSON.parse(msg.data)\n\t\t\t\tdata.id = this.id++\n\t\t\t\tdata.role = 'server'\n\t\t\t\tvar list = this.list\n\t\t\t\tlist.push(data)\n\t\t\t\tthis.list = list\n\t\t\t\tthis.rollingBottom()\n\t\t\t})\n\t\t},\n\t\t//重新连接\n\t\treconnect() {\n\t\t\tvar that = this;\n\t\t\tif (that.lockReconnect) return;\n\t\t\tthat.lockReconnect = true;\n\t\t\tclearTimeout(that.timer)\n\t\t\t// console.log(that.limit)\n\t\t\tif (that.limit < 10) { //连接10次后不再重新连接\n\t\t\t\tthat.timer = setTimeout(() => {\n\t\t\t\t\tthat.linkSocket();\n\t\t\t\t\tthat.lockReconnect = false;\n\t\t\t\t\tconsole.log(\"次数:\", that.limit)\n\t\t\t\t}, 5000); //每隔5秒连接一次\n\t\t\t\tthat.limit = that.limit + 1\n\t\t\t}\n\t\t},\n\t\tsend: function() {\n\t\t\t// 判断发送内容是否为空\n\t\t\tif (this.message) {\n\t\t\t\twx.sendSocketMessage({\n\t\t\t\t\tdata: this.message,\n\t\t\t\t})\n\t\t\t\t// 我自己的消息\n\t\t\t\t// console.log(this.list)\n\t\t\t\tvar list = this.list\n\t\t\t\tlist.push({\n\t\t\t\t\tid: this.count++,\n\t\t\t\t\tcontent: this.message,\n\t\t\t\t\trole: 'me'\n\t\t\t\t})\n\t\t\t\tthis.list = list;\n\t\t\t\tthis.message = '';\n\t\t\t\tthis.rollingBottom()\n\t\t\t} else {\n\t\t\t\t// 弹出提示框\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '消息不能为空哦~',\n\t\t\t\t\ticon: 'none',\n\t\t\t\t\tduration: 2000\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\tscroll: function(e) {\n\t\t\tconsole.log(e.detail.scrollTo)\n\t\t},\n\t\t// 监听input值的改变\n\t\tbindChange(res) {\n\t\t\tthis.message = res.detail.value\n\t\t},\n\t\t// 页面卸载，关闭连接\n\t\tonUnload() {\n\t\t\twx.onSocketClose();\n\t\t\twx.showToast({\n\t\t\t\ttitle: '连接已断开~',\n\t\t\t\ticon: 'none',\n\t\t\t\tduration: 2000\n\t\t\t})\n\t\t},\n\t\t// 聊天内容始终显示在最低端\n\t\trollingBottom(e) {\n\t\t\tuni.createSelectorQuery().selectAll('.list').boundingClientRect(rects => {\n\t\t\t\trects.forEach(rect => {\n\t\t\t\t\tthis.scrollTop = rect.bottom;\n\t\t\t\t})\n\t\t\t}).exec()\n\t\t}\n\t}\n}\n","import mod from \"-!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-1!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\index.js??ref--6-oneOf-1-2!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=style&index=0&id=1b4abb47&scoped=true&lang=css&\"; export default mod; export * from \"-!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-1!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\index.js??ref--6-oneOf-1-2!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=style&index=0&id=1b4abb47&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin"],"sourceRoot":""}